window.__require=function t(e,o,n){function i(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var u="function"==typeof __require&&__require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var f=o[c]={exports:{}};e[c][0].call(f.exports,function(t){return i(e[c][1][t]||t)},f,f.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({AdditionView:[function(t,e,o){"use strict";cc._RF.push(e,"9401bswLVdPuKMgEHvN6rze","AdditionView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../common/Const"),c=t("../prefab/Addition"),a=cc._decorator,s=a.ccclass,u=a.property,f=function(){return function(){}}(),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.item=null,e}return n(e,t),e.prototype.start=function(){for(var t=this.node.width/r.Arms_word.length,e=0;e<r.Arms_word.length;++e){var o=cc.instantiate(this.item);o.getComponent(c.default).initAddition(e),this.node.addChild(o),o.scale=1.3,o.x=-this.node.width/2+t/2+e*t,o.y=25}},e.prototype.resetAddition=function(){this.node.children.forEach(function(t,e){t.getComponent(c.default).initAddition(e)})},e.prototype.doAddition=function(t,e){var o=this,n=[],i=new f;switch(t){case r.GUA_XIANG.QIAN:for(var a=0;a<r.Arms_word.length;++a){var s=new f;s.arm=a,s.attack=.2,s.defence=.1,s.energy=3,n.push(s)}break;case r.GUA_XIANG.KAN:i.arm=r.Arms.Gong,i.attack=.6,i.defence=.2,i.energy=10,n.push(i);break;case r.GUA_XIANG.GEN:i.arm=r.Arms.Dun,i.attack=.2,i.defence=1.2,i.energy=10,n.push(i);break;case r.GUA_XIANG.ZHEN:i.arm=r.Arms.Dao,i.attack=.6,i.defence=.2,i.energy=10,n.push(i);break;case r.GUA_XIANG.XUN:i.arm=r.Arms.Qi,i.attack=1,i.defence=.2,i.energy=10,n.push(i);break;case r.GUA_XIANG.LI:i.arm=r.Arms.Jun,i.attack=.6,i.defence=.2,i.energy=10,n.push(i);break;case r.GUA_XIANG.KUN:i.arm=r.Arms.Che,i.attack=.5,i.defence=.5,i.energy=10,n.push(i);break;case r.GUA_XIANG.DUI:i.arm=r.Arms.Qiang,i.attack=.6,i.defence=.3,i.energy=10,n.push(i)}return n.forEach(function(t){var n=o.node.children[t.arm].getComponent(c.default).doAddition(t.attack*e/3,t.defence*e/3),i=n[0],r=n[1];t.attack=i,t.defence=r,t.energy*=e}),n},i([u(cc.Prefab)],e.prototype,"item",void 0),e=i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../common/Const":"Const","../prefab/Addition":"Addition"}],Addition:[function(t,e,o){"use strict";cc._RF.push(e,"cce52KBCnBDsavXIqTCGEVS","Addition");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../common/Const"),c=cc._decorator,a=c.ccclass,s=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lb_arm=null,e.lb_data1=null,e.lb_data2=null,e._addAttack=0,e._addDefence=0,e}return n(e,t),Object.defineProperty(e.prototype,"arm",{set:function(t){this._arm=t,this.lb_arm.string=r.Arms_word[t]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"addAttack",{get:function(){return this._addAttack},set:function(t){this._addAttack=t;var e="\u653b";this._addAttack>0?(this.lb_data1.node.color=cc.Color.GREEN,e=e+"+"+Math.floor(100*this._addAttack)+"%"):this._addAttack<0?(this.lb_data1.node.color=cc.Color.RED,e=e+Math.floor(100*this._addAttack)+"%"):(e="\u653b+0%",this.lb_data1.node.color=cc.Color.BLACK),this.lb_data1.string=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"addDefence",{get:function(){return this._addDefence},set:function(t){this._addDefence=t;var e="\u9632";this._addDefence>0?(this.lb_data2.node.color=cc.Color.GREEN,e=e+"+"+Math.floor(100*this._addDefence)+"%"):this._addDefence<0?(this.lb_data2.node.color=cc.Color.RED,e=e+Math.floor(100*this._addDefence)+"%"):(e="\u9632+0%",this.lb_data2.node.color=cc.Color.BLACK),this.lb_data2.string=e},enumerable:!1,configurable:!0}),e.prototype.initAddition=function(t){this.addAttack=0,this.addDefence=0,this.arm=t},e.prototype.doAddition=function(t,e){return this.addAttack+=t,this.addDefence+=e,[this.addAttack,this.addDefence]},i([s(cc.Label)],e.prototype,"lb_arm",void 0),i([s(cc.Label)],e.prototype,"lb_data1",void 0),i([s(cc.Label)],e.prototype,"lb_data2",void 0),e=i([a],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../common/Const":"Const"}],BuffComponent:[function(t,e,o){"use strict";cc._RF.push(e,"ff99asDq61LappWKiQBIF8I","BuffComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BuffData"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._buffId=r.BuffId.NULL,e}return n(e,t),Object.defineProperty(e.prototype,"buffId",{get:function(){return this._buffId},set:function(t){if(this._buffId!==t){this._buffId=t;var e=r.default(t);this.buffName=e.name,this.buffIcon=e.icon,this.buffTime=e.dotime,this.continued=e.continued,this.buffType=e.type,this.doFunc=e.func}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffName",{get:function(){return this._buffName},set:function(t){this._buffName=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffIcon",{get:function(){return this._buffIcon},set:function(t){this._buffIcon=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffTime",{get:function(){return this._buffTime},set:function(t){this._buffTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"continued",{get:function(){return this._continued},set:function(t){this._continued=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffType",{get:function(){return this._buffType},set:function(t){this._buffType=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doFunc",{get:function(){return this._doFunc},set:function(t){this._doFunc=t},enumerable:!1,configurable:!0}),e.prototype.initBuff=function(t){this.buffId=t},e=i([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{"./BuffData":"BuffData"}],BuffData:[function(t,e,o){"use strict";var n;cc._RF.push(e,"e68415/lFtFMLRvOSn+tK/j","BuffData"),Object.defineProperty(o,"__esModule",{value:!0}),o.BuffId=void 0;var i,r=t("./SkillConst");(function(t){t[t.NULL=0]="NULL",t[t.KongCheng=1]="KongCheng"})(i=o.BuffId||(o.BuffId={})),o.default=function(t){return new c(a[t])};var c=function(){return function(t){this.name=t.name,this.icon=t.icon,this.dotime=t.dotime,this.continued=t.continued,this.type=t.type,this.func=t.func}}(),a=((n={})[i.KongCheng]={name:"\u7a7a\u57ce",icon:"",dotime:r.BuffTime.onAttack,type:r.BuffType.Reduce,continued:0,func:function(t,e){return 0}},n);cc._RF.pop()},{"./SkillConst":"SkillConst"}],Const:[function(t,e,o){"use strict";cc._RF.push(e,"9f654Hccu5ES6ZMaIiGjeYn","Const"),Object.defineProperty(o,"__esModule",{value:!0}),o.MAX_ROW=o.MAX_COL=o.HERO_COUNT=o.MAX_DEFENCE=o.MAX_ENERGY=o.Arms_word=o.Arms=o.GUA_XIANG=o.CAMPS=o.EventType=void 0,function(t){t.TABLE_INIT_OVER="table_init_over",t.HERO_ATTACK="hero_attack",t.HERO_ON_ATTACK="hero_on_attack",t.HERO_ON_SKILL_ATTACK="hero_on_skill_attack",t.CHECK_GUA="check_gua"}(o.EventType||(o.EventType={})),function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(o.CAMPS||(o.CAMPS={})),function(t){t[t.QIAN=0]="QIAN",t[t.KAN=1]="KAN",t[t.GEN=2]="GEN",t[t.ZHEN=3]="ZHEN",t[t.XUN=4]="XUN",t[t.LI=5]="LI",t[t.KUN=6]="KUN",t[t.DUI=7]="DUI"}(o.GUA_XIANG||(o.GUA_XIANG={})),function(t){t[t.Gong=0]="Gong",t[t.Dao=1]="Dao",t[t.Qi=2]="Qi",t[t.Dun=3]="Dun",t[t.Che=4]="Che",t[t.Jun=5]="Jun",t[t.Qiang=6]="Qiang"}(o.Arms||(o.Arms={})),o.Arms_word=["\u5f13","\u5200","\u9a91","\u76fe","\u8f66","\u519b","\u67aa"],o.MAX_ENERGY=100,o.MAX_DEFENCE=100,o.HERO_COUNT=5,o.MAX_COL=3,o.MAX_ROW=3,cc._RF.pop()},{}],EventManager:[function(t,e,o){"use strict";cc._RF.push(e,"846efnL7PFNDoxx7jZsg5Mw","EventManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.emit=function(t,e){var o=new cc.Event.EventCustom(t,!0);null!==e&&o.setUserData(e),this._target.dispatchEvent(o)},t.on=function(t,e,o,n){this._target.on(t,e,o,n)},t.off=function(t,e,o){this._target.off(t,e,o)},t._target=new cc.EventTarget,t}();o.default=n,cc._RF.pop()},{}],GameModel:[function(t,e,o){"use strict";cc._RF.push(e,"07c5fo94rFHc5BOsxT7ODC9","GameModel"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../common/Const"),i=function(){function t(){}return t.calculateDamage=function(t,e,o){return void 0===o&&(o=1),Math.ceil(t*o*(n.MAX_DEFENCE-e)/n.MAX_DEFENCE)},t}();o.default=i,cc._RF.pop()},{"../common/Const":"Const"}],GameView:[function(t,e,o){"use strict";cc._RF.push(e,"cf647gIawpJX6Y5aoFpH4nR","GameView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../common/Const"),c=t("../common/EventManager"),a=t("../common/Tools"),s=t("../prefab/Hero"),u=t("../ui/TableView"),f=t("../model/GameModel"),l=t("../ui/GuaView"),p=t("../ui/AdditionView"),h=t("../prefab/Gua"),d=t("../entity/HeroEntity"),_=cc._decorator,y=_.ccclass,g=_.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.table=null,e.hero=null,e.gameBtn=null,e.guaView=null,e.additionView=null,e.leftList=[],e.rightList=[],e.labelpool=new cc.NodePool,e.btnGfx=null,e}return n(e,t),e.prototype.onLoad=function(){a.default.setSeed(Date.now()),d.HeroEntity.instance.init(this.hero),this.initGameBtn(),c.default.on(r.EventType.TABLE_INIT_OVER,this.initHeros,this),c.default.on(r.EventType.HERO_ATTACK,this.playAttack,this),c.default.on(r.EventType.HERO_ON_ATTACK,this.onAttack,this),c.default.on(r.EventType.HERO_ON_SKILL_ATTACK,this.onAttackSkill,this),c.default.on(r.EventType.CHECK_GUA,this.checkGua,this)},e.prototype.onDestroy=function(){c.default.off(r.EventType.TABLE_INIT_OVER,this.initHeros,this),c.default.off(r.EventType.HERO_ATTACK,this.playAttack,this),c.default.off(r.EventType.HERO_ON_ATTACK,this.onAttack,this),c.default.off(r.EventType.HERO_ON_SKILL_ATTACK,this.onAttackSkill,this),c.default.off(r.EventType.CHECK_GUA,this.checkGua,this)},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){a.default.setOffsetUV(t.bg)},0)},e.prototype.initGameBtn=function(){var t=this;this.btnGfx=this.gameBtn.getComponent(cc.Graphics);var e=this.gameBtn.getComponent(cc.Button);this.gameBtn.on(cc.Node.EventType.TOUCH_START,function(){e.interactable&&t.refreshGameBtn(cc.Color.GREEN)}),this.gameBtn.on(cc.Node.EventType.TOUCH_END,function(){e.interactable&&(t.beginNewRound(),e.interactable=!1,t.refreshGameBtn(cc.Color.GRAY))}),this.gameBtn.on(cc.Node.EventType.TOUCH_CANCEL,function(){e.interactable&&t.refreshGameBtn(cc.Color.RED)}),this.refreshGameBtn(cc.Color.RED)},e.prototype.refreshGameBtn=function(t){void 0===t&&(t=cc.Color.WHITE),this.btnGfx.clear(),this.btnGfx.fillColor=t,this.btnGfx.arc(0,0,this.gameBtn.width/2-4,0,360,!1),this.btnGfx.stroke(),this.btnGfx.fill()},e.prototype.initHeros=function(){for(var t=this.table.getRects(),e=t.slice(0,9),o=t.slice(9),n=1e4,i=function(o){var i=d.HeroEntity.instance.createHero(),u=i.getComponent(s.default);c.node.addChild(i);var f=a.default.randomInt(e.length),l=e[f];e=e.filter(function(t){return!t.equals(l)});var p=c.table.node.convertToWorldSpaceAR(cc.v2(l.x+l.width/2,l.y+l.height/2)),h=c.node.convertToNodeSpaceAR(p),_=t.indexOf(l),y=Math.floor(_/r.MAX_COL),g=_%r.MAX_ROW;u.onInit(h,y,g,++n),u.camp=r.CAMPS.LEFT,c.leftList.push(i),d.HeroEntity.instance.pushHero(i,r.CAMPS.LEFT,y,g)},c=this,u=0;u<r.HERO_COUNT;++u)i();var f=function(e){var i=d.HeroEntity.instance.createHero(),c=i.getComponent(s.default);l.node.addChild(i);var u=a.default.randomInt(o.length),f=o[u];o=o.filter(function(t){return!t.equals(f)});var p=l.table.node.convertToWorldSpaceAR(cc.v2(f.x+f.width/2,f.y+f.height/2)),h=l.node.convertToNodeSpaceAR(p),_=t.indexOf(f)-9,y=Math.floor(_/r.MAX_COL),g=_%r.MAX_ROW;c.onInit(h,y,g,++n),c.camp=r.CAMPS.RIGHT,l.rightList.push(i),d.HeroEntity.instance.pushHero(i,r.CAMPS.RIGHT,y,g)},l=this;for(u=0;u<r.HERO_COUNT;++u)f()},e.prototype.beginNewRound=function(){this.additionView.resetAddition(),this.guaView.newRound(!0)},e.prototype.doAttack=function(t,e){if(e>=9)return this.gameBtn.getComponent(cc.Button).interactable=!0,this.refreshGameBtn(cc.Color.RED),this.leftList.forEach(function(t){t.getComponent(s.default).checkBuff()}),void this.rightList.forEach(function(t){t.getComponent(s.default).checkBuff()});var o,n,i,c;switch(t){case r.CAMPS.LEFT:o=this.table.getRects().slice(0,9),n=this.leftList,i=r.CAMPS.RIGHT,c=e,o.sort(function(t,e){return t.x>e.x?-1:t.x<e.x?1:e.y-t.y});break;case r.CAMPS.RIGHT:o=this.table.getRects().slice(9),n=this.rightList,i=r.CAMPS.LEFT,c=e+1,o.sort(function(t,e){return t.x>e.x?1:t.x<e.x?-1:e.y-t.y});break;default:return void console.log("do attack erro===>",t,e)}var a=this.getHeroByRect(n,o[e]);a&&!a.isdead?a.sendAttack(i,c):this.doAttack(i,c)},e.prototype.getHeroByRect=function(t,e){var o,n=this,i=this.table.node.convertToWorldSpaceAR(cc.v2(e.x+e.width/2,e.y+e.height/2));return t.forEach(function(t){var e=t.getComponent(s.default);n.node.convertToWorldSpaceAR(e.pos).equals(i)&&(o=e)}),o},e.prototype.resetGame=function(){for(var t=this.table.getRects(),e=t.slice(0,9),o=t.slice(9),n=1e4,i=function(t){var o=c.leftList[t].getComponent(s.default),i=a.default.randomInt(e.length),r=e[i];e=e.filter(function(t){return!t.equals(r)});var u=c.table.node.convertToWorldSpaceAR(cc.v2(r.x+r.width/2,r.y+r.height/2)),f=c.node.convertToNodeSpaceAR(u);o.onInit(f,Math.floor(i/3),i%3,++n)},c=this,u=0;u<r.HERO_COUNT;++u)i(u);var f=function(t){var i=l.rightList[t].getComponent(s.default),r=a.default.randomInt(e.length),c=o[r];o=o.filter(function(t){return!t.equals(c)});var u=l.table.node.convertToWorldSpaceAR(cc.v2(c.x+c.width/2,c.y+c.height/2)),f=l.node.convertToNodeSpaceAR(u);i.onInit(f,Math.floor(r/3),r%3,++n)},l=this;for(u=0;u<r.HERO_COUNT;++u)f(u)},e.prototype.playAttack=function(t){var e=t.getUserData(),o=this.getAttackHero(e),n=o[0],i=o[1],r=this.getRandomTarget(i,n);r?i.doAttack(r):console.log("playAttack err")},e.prototype.getAttackHero=function(t){var e,o,n=t.camp;switch(n){case r.CAMPS.LEFT:e=this.leftList;break;case r.CAMPS.RIGHT:e=this.rightList;break;default:return void console.log("get hero error==>",t)}return e.forEach(function(e){e.getComponent(s.default).hero_id!==t.id||(o=e.getComponent(s.default))}),[n,o]},e.prototype.getRandomTarget=function(t,e){var o;switch(t.arm){case r.Arms.Gong:case r.Arms.Jun:o=d.HeroEntity.instance.getLast(e,!0);break;default:o=d.HeroEntity.instance.getFront(e,!0)}if(0!==o.length)return o[a.default.randomInt(o.length)].getComponent(s.default);console.log("getRandomTarget err",t.heroname,t.arm,e)},e.prototype.checkGameOver=function(t){var e=this.leftList.filter(function(t){return!t.getComponent(s.default).isdead}),o=this.rightList.filter(function(t){return!t.getComponent(s.default).isdead});e.length<=0||o.length<=0||this.doAttack(t.camp,t.index)},e.prototype.onAttack=function(t){var e=this,o=t.getUserData(),n=o.target,i=f.default.calculateDamage(o.from.attack,n.defence);i=n.onAttack(i);var r=this.getLabel();r.string="-"+i,r.node.color=cc.Color.RED;var c=n.node.parent.convertToWorldSpaceAR(n.pos),a=this.node.convertToNodeSpaceAR(c);cc.tween(r.node).set({x:a.x,y:a.y+30,opacity:255}).to(.5,{y:a.y+50,opacity:0}).call(function(){e.labelpool.put(r.node)}).start(),this.scheduleOnce(function(){e.checkGameOver(o)},.2)},e.prototype.onAttackSkill=function(t){var e=this,o=t.getUserData(),n=this.getLabel();n.string=o.name,n.node.color=cc.Color.RED,n.node.scale=.8;var i=o.from.node.parent.convertToWorldSpaceAR(o.pos),r=this.node.convertToNodeSpaceAR(i);cc.tween(n.node).set({x:r.x,y:r.y+30,opacity:255}).to(.5,{y:r.y+50}).to(.3,{opacity:0}).call(function(){e.labelpool.put(n.node)}).start(),o.targets.forEach(function(t){var i=t.getComponent(s.default),r=f.default.calculateDamage(o.from.attack,i.defence,o.rate);r=i.onSkill(r),(n=e.getLabel()).string="-"+r,n.node.color=cc.Color.RED;var c=i.node.parent.convertToWorldSpaceAR(i.pos),a=e.node.convertToNodeSpaceAR(c);cc.tween(n.node).set({x:a.x,y:a.y+30,opacity:255}).delay(.5).to(.5,{y:a.y+50,opacity:0}).call(function(){e.labelpool.put(n.node)}).start()}),this.scheduleOnce(function(){e.checkGameOver(o)},1)},e.prototype.getLabel=function(){var t=null;return this.labelpool.size()>0?t=this.labelpool.get():(t=new cc.Node).addComponent(cc.Label),t.scale=.5,this.node.addChild(t),t.getComponent(cc.Label)},e.prototype.checkGua=function(t){var e=this,o=t.getUserData();this.leftList.forEach(function(t){t.getComponent(s.default).resetAddition()}),this.rightList.forEach(function(t){t.getComponent(s.default).resetAddition()}),o.forEach(function(t){var o=t[0].getComponent(h.default).getCheckId(!1);e.additionView.doAddition(o,t.length).forEach(function(t){e.leftList.forEach(function(e){e.getComponent(s.default).doAddition(t.arm,t.attack,t.defence,t.energy)}),e.rightList.forEach(function(e){e.getComponent(s.default).doAddition(t.arm,t.attack,t.defence,t.energy)})})}),this.doAttack(r.CAMPS.LEFT,0)},e.prototype.getHeroList=function(t){switch(t){case r.CAMPS.LEFT:return this.leftList;case r.CAMPS.RIGHT:return this.rightList}return[]},i([g(cc.Sprite)],e.prototype,"bg",void 0),i([g(u.default)],e.prototype,"table",void 0),i([g(cc.Prefab)],e.prototype,"hero",void 0),i([g(cc.Node)],e.prototype,"gameBtn",void 0),i([g(l.default)],e.prototype,"guaView",void 0),i([g(p.default)],e.prototype,"additionView",void 0),e=i([y],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../common/Const":"Const","../common/EventManager":"EventManager","../common/Tools":"Tools","../entity/HeroEntity":"HeroEntity","../model/GameModel":"GameModel","../prefab/Gua":"Gua","../prefab/Hero":"Hero","../ui/AdditionView":"AdditionView","../ui/GuaView":"GuaView","../ui/TableView":"TableView"}],GuaView:[function(t,e,o){"use strict";cc._RF.push(e,"35be0C2muBG9ooB3KYy8tBa","GuaView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../prefab/Gua"),c=t("../common/EventManager"),a=t("../common/Const"),s=cc._decorator,u=s.ccclass,f=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gua=null,e.guaNodes=[],e.gfx=null,e}return n(e,t),e.prototype.onLoad=function(){this.gfx=this.node.getComponent(cc.Graphics),this.drawRect()},e.prototype.start=function(){this.newRound()},e.prototype.drawRect=function(){this.gfx.moveTo(-this.node.height/2,-this.node.height/2),this.gfx.rect(-this.node.height/2,-this.node.height/2,this.node.height,this.node.height),this.gfx.stroke()},e.prototype.newRound=function(t){if(void 0===t&&(t=!1),0===this.guaNodes.length)for(var e=this.node.height/6,o=0;o<6;++o){for(var n=[],i=0;i<6;++i){var c=cc.instantiate(this.gua);this.node.addChild(c),n.push(c),c.x=5*-e/2+o*e,c.y=5*e/2-i*e}this.guaNodes.push(n)}this.guaNodes.forEach(function(t){t.forEach(function(t){t.getComponent(r.default).drawRandomGua()})}),t&&this.checkGua()},e.prototype.checkGua=function(){for(var t=[],e=0;e<this.guaNodes.length;++e)for(var o=0;o<this.guaNodes[e].length;++o){var n=this.guaNodes[e][o],i=[];i.push(n);var s=n.getComponent(r.default).getCheckId();null!==s&&(this.checkGuaItem(e-1,o,s,i),this.checkGuaItem(e,o-1,s,i),this.checkGuaItem(e,o+1,s,i),this.checkGuaItem(e+1,o,s,i),i.length>=3&&(i.forEach(function(t){t.getComponent(r.default).setCheck()}),t.push(i)))}c.default.emit(a.EventType.CHECK_GUA,t)},e.prototype.checkGuaItem=function(t,e,o,n){if(this.guaNodes[t]&&this.guaNodes[t][e]){var i=this.guaNodes[t][e];-1==n.indexOf(i)&&i.getComponent(r.default).getCheckId()===o&&(n.push(i),this.checkGuaItem(t-1,e,o,n),this.checkGuaItem(t,e-1,o,n),this.checkGuaItem(t,e+1,o,n),this.checkGuaItem(t+1,e,o,n))}},i([f(cc.Prefab)],e.prototype,"gua",void 0),e=i([u],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../common/Const":"Const","../common/EventManager":"EventManager","../prefab/Gua":"Gua"}],Gua:[function(t,e,o){"use strict";cc._RF.push(e,"56b0dsH3G1LR4E3H+mZJAgN","Gua");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../common/Const"),c=t("../common/Tools"),a=cc._decorator,s=a.ccclass,u=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gfx=null,e.width=0,e.isCheck=!1,e}return n(e,t),e.prototype.onLoad=function(){this.gfx=this.node.getComponent(cc.Graphics),this.width=this.node.width},e.prototype.drawRandomGua=function(){this.isCheck=!1,this.guaId=c.default.randomInt(8),this.drawGua(this.guaId)},e.prototype.setCheck=function(){this.isCheck=!0,this.drawGua(this.guaId)},e.prototype.getCheckId=function(t){return void 0===t&&(t=!0),t&&this.isCheck?null:this.guaId},e.prototype.drawGua=function(t){switch(this.gfx.clear(),t){case r.GUA_XIANG.QIAN:this.drawQianGua();break;case r.GUA_XIANG.KAN:this.drawKanGua();break;case r.GUA_XIANG.GEN:this.drawGenGua();break;case r.GUA_XIANG.ZHEN:this.drawZhenGua();break;case r.GUA_XIANG.XUN:this.drawXunGua();break;case r.GUA_XIANG.LI:this.drawLiGua();break;case r.GUA_XIANG.KUN:this.drawKunGua();break;case r.GUA_XIANG.DUI:this.drawDuiGua()}},e.prototype.drawQianGua=function(){this.drawBackGround(this.isCheck?cc.color(255,255,0,255):cc.Color.WHITE),this.drawYao(1,0),this.drawYao(1,1),this.drawYao(1,2)},e.prototype.drawKanGua=function(){this.drawBackGround(this.isCheck?cc.color(0,0,128,255):cc.Color.WHITE),this.drawYao(0,0),this.drawYao(1,1),this.drawYao(0,2)},e.prototype.drawGenGua=function(){this.drawBackGround(this.isCheck?cc.color(128,128,0,255):cc.Color.WHITE),this.drawYao(1,0),this.drawYao(0,1),this.drawYao(0,2)},e.prototype.drawZhenGua=function(){this.drawBackGround(this.isCheck?cc.color(0,0,255,255):cc.Color.WHITE),this.drawYao(0,0),this.drawYao(0,1),this.drawYao(1,2)},e.prototype.drawXunGua=function(){this.drawBackGround(this.isCheck?cc.color(192,192,192,255):cc.Color.WHITE),this.drawYao(1,0),this.drawYao(1,1),this.drawYao(0,2)},e.prototype.drawLiGua=function(){this.drawBackGround(this.isCheck?cc.color(255,0,0,255):cc.Color.WHITE),this.drawYao(1,0),this.drawYao(0,1),this.drawYao(1,2)},e.prototype.drawKunGua=function(){this.drawBackGround(this.isCheck?cc.color(192,192,0,255):cc.Color.WHITE),this.drawYao(0,0),this.drawYao(0,1),this.drawYao(0,2)},e.prototype.drawDuiGua=function(){this.drawBackGround(this.isCheck?cc.color(192,192,64,255):cc.Color.WHITE),this.drawYao(0,0),this.drawYao(1,1),this.drawYao(1,2)},e.prototype.drawBackGround=function(t){this.gfx.fillColor=t,this.gfx.moveTo(0,0),this.gfx.arc(0,0,this.width/2,0,360,!1),this.gfx.fill()},e.prototype.drawYao=function(t,e){var o=this.width-40,n=cc.v2(-o/2,-20*e+15);0==t?(this.gfx.fillColor=cc.Color.BLACK,this.gfx.moveTo(n.x,n.y),this.gfx.fillRect(n.x,n.y,o/2-5,10),this.gfx.moveTo(5,n.y),this.gfx.fillRect(5,n.y,o/2-5,10)):(this.gfx.moveTo(n.x,n.y),this.gfx.fillColor=cc.Color.BLACK,this.gfx.fillRect(n.x,n.y,o,10))},e=i([s],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../common/Const":"Const","../common/Tools":"Tools"}],HeroEntity:[function(t,e,o){"use strict";cc._RF.push(e,"06382zMeJRPwp8ST3i64xhO","HeroEntity"),Object.defineProperty(o,"__esModule",{value:!0}),o.HeroEntity=void 0;var n=t("../common/Const"),i=t("../prefab/Hero"),r=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(t){this._prefab=t,this._pool=new cc.NodePool,this._leftMap=new Map,this._rightMap=new Map},t.prototype.createHero=function(){return this._pool.size()>0?this._pool.get():cc.instantiate(this._prefab)},t.prototype.deleteHero=function(t){this._pool.put(t);var e,o=t.getComponent(i.default).camp,n=this.getMapByCamp(o,!1);n.forEach(function(o,n,i){o!==t||(e=n)}),e&&n.delete(e)},t.prototype.pushHero=function(t,e,o,n){var i=""+o+n;this.getMapByCamp(e,!1).set(i,t)},t.prototype.getHeros=function(t,e,o,i){void 0===e&&(e=!0),void 0===o&&(o=-1),void 0===i&&(i=-1);var r=[],c=this.getMapByCamp(t,e);if(o>=0&&i>=0){var a=""+o+i;r.push(c.get(a))}else if(o>=0)for(var s=0;s<n.MAX_ROW;++s){a=""+o+s;c.get(a)&&r.push(c.get(a))}else if(i>=0)for(var u=0;u<n.MAX_COL;++u){a=""+u+i;c.get(a)&&r.push(c.get(a))}else c.forEach(function(t,e,o){r.push(t)});return r},t.prototype.getFront=function(t,e){for(var o=0,i=this.getHeros(t,e,o++);0==i.length&&o<n.MAX_COL;)i=this.getHeros(t,e,o++);return 0===i.length&&console.log(o,this._leftMap,this._rightMap),i},t.prototype.getLast=function(t,e){for(var o=n.MAX_COL-1,i=this.getHeros(t,e,o--);0==i.length&&o>=0;)i=this.getHeros(t,e,o--);return 0===i.length&&console.log(o,this._leftMap,this._rightMap),i},t.prototype.getMapByCamp=function(t,e){return e&&(t=t===n.CAMPS.LEFT?n.CAMPS.RIGHT:n.CAMPS.LEFT),t===n.CAMPS.LEFT?this._leftMap:this._rightMap},t._instance=new t,t}();o.HeroEntity=r,cc._RF.pop()},{"../common/Const":"Const","../prefab/Hero":"Hero"}],Hero:[function(t,e,o){"use strict";cc._RF.push(e,"0f1124T45JGQrc2TGpj9mtf","Hero");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../common/Const"),c=t("../common/EventManager"),a=t("../skill/SkillComponent"),s=t("../skill/SkillData"),u=t("../skill/SkillSystem"),f=t("../skill/SkillConst"),l=t("../skill/BuffComponent"),p=t("../common/Tools"),h=t("../entity/HeroEntity"),d=cc._decorator,_=d.ccclass,y=d.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lb_name=null,e.lb_hp=null,e.lb_data=null,e.pb_hp=null,e.pb_eg=null,e.lb_arm=null,e.node_skill=null,e.node_buff=null,e._hp=0,e._maxHp=0,e._hero_name="",e._attack=0,e._defence=0,e._dead=!1,e._camp=0,e._pos=cc.v2(0,0),e._energy=0,e._hero_id=0,e._nextCamp=0,e._nextIndex=0,e._buffAttack=0,e._buffDefence=0,e._initAttack=0,e._initDefence=0,e._col=0,e._row=0,e}return n(e,t),Object.defineProperty(e.prototype,"hp",{get:function(){return this._hp},set:function(t){this._hp=Math.min(Math.round(t),this.maxHp),this.hp<=0?(this.isdead=!0,h.HeroEntity.instance.deleteHero(this.node)):(this.lb_hp.string=this.hp+"/"+this.maxHp,this.pb_hp.progress=this.hp/this.maxHp)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxHp",{get:function(){return this._maxHp},set:function(t){var e=Math.round(t);this._maxHp=e,this.hp=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroname",{get:function(){return this._hero_name},set:function(t){this._hero_name=t,this.lb_name.string=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attack",{get:function(){return this._attack},set:function(t){this._attack=Math.round(t),this.displayData()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defence",{get:function(){return this._defence},set:function(t){this._defence=Math.min(Math.round(t),r.MAX_DEFENCE),this.displayData()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isdead",{get:function(){return this._dead},set:function(t){this._dead=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"camp",{get:function(){return this._camp},set:function(t){this._camp=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pos",{get:function(){return this._pos},set:function(t){this._pos.equals(t)||(this._pos=t),this.node.setPosition(this.pos)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"energy",{get:function(){return this._energy},set:function(t){this._energy=Math.min(t,r.MAX_ENERGY),this.pb_eg.progress=this.energy/r.MAX_ENERGY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hero_id",{get:function(){return this._hero_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"arm",{get:function(){return this._arm},set:function(t){this._arm=t,this.lb_arm.string=r.Arms_word[t]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffAttack",{get:function(){return this._buffAttack},set:function(t){this._buffAttack=t,this.attack=this.initAttack*(1+this._buffAttack)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffDefence",{get:function(){return this._buffDefence},set:function(t){this._buffDefence=t,this.defence=this.initDefence*(1+this._buffDefence)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initAttack",{get:function(){return this._initAttack},set:function(t){this._initAttack=t,this.attack=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initDefence",{get:function(){return this._initDefence},set:function(t){this._initDefence=t,this.defence=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"row",{get:function(){return this._row},set:function(t){this._row=t},enumerable:!1,configurable:!0}),e.prototype.onInit=function(t,e,o,n){var i,c=Object.keys(r.Arms).filter(function(t){return isNaN(parseInt(t))}),u=["\u66f9\u64cd","\u5218\u5907","\u5b59\u6743","\u9646\u900a","\u5468\u745c","\u8bf8\u845b\u4eae","\u53f8\u9a6c\u61ff","\u90ed\u5609","\u8340\u5f67","\u620f\u5fd7\u624d","\u8d3e\u8be9","\u9c81\u8083","\u6cd5\u6b63","\u59dc\u7ef4","\u8d75\u4e91","\u5415\u5e03","\u5173\u7fbd","\u5f20\u98de"],f=p.default.random();switch(this.heroname=u[Math.floor(f*u.length)],this.maxHp=200+100*f,this.initAttack=50+20*f,this.initDefence=20+10*f,this.arm=Math.floor(f*c.length),this.isdead=!1,this.pos=t,this.energy=0,this._hero_id=n,this.node.zIndex=0,this.col=e,this.row=o,this.heroname){case u[5]:i=s.SkillId.KongCheng;break;case u[17]:i=s.SkillId.HuXiaoDangYang;break;case u[16]:i=s.SkillId.DanDaoFuHui}if(i){var l=this.node_skill.addComponent(a.default);this.scheduleOnce(function(){l.initSkill(i)},0)}},e.prototype.sendAttack=function(t,e){this._nextCamp=t,this._nextIndex=e;var o={camp:this.camp,id:this.hero_id};this.energy>=r.MAX_ENERGY&&u.default.instance.doCheckSkill(this,f.SkillType.Attack)?this.energy=0:c.default.emit(r.EventType.HERO_ATTACK,o)},e.prototype.doAttack=function(t){var e=this;this.node.zIndex=1;var o=this.camp===r.CAMPS.LEFT?-1:1,n=t.pos.add(cc.v2(.9*this.node.width*o,0));cc.tween(this.node).to(.1,{x:n.x,y:n.y},{easing:"cubicOut"}).call(function(){c.default.emit(r.EventType.HERO_ON_ATTACK,{target:t,from:e,camp:e._nextCamp,index:e._nextIndex})}).to(.1,{x:this.pos.x,y:this.pos.y},{easing:"cubicOut"}).call(function(){e.node.zIndex=0}).start()},e.prototype.doSkill=function(t,e,o,n){var i=this;this.node.zIndex=1,cc.tween(this.node).to(.1,{x:o.x,y:o.y},{easing:"cubicOut"}).call(function(){c.default.emit(r.EventType.HERO_ON_SKILL_ATTACK,{targets:t,pos:o,name:n,from:i,rate:e,camp:i._nextCamp,index:i._nextIndex})}).delay(.5).to(.1,{x:this.pos.x,y:this.pos.y},{easing:"cubicOut"}).call(function(){i.node.zIndex=0}).start()},e.prototype.onAttack=function(t){var e=this,o=u.default.instance.doCheckBuff(this,f.BuffTime.onAttack);return o&&o.buffType===f.BuffType.Reduce&&(t=o.doFunc(this,t)),cc.tween(this.node).delay(.1).to(.05,{scale:.8}).call(function(){e.hp-=t}).to(.05,{scale:1}).start(),t},e.prototype.onSkill=function(t){var e=this,o=u.default.instance.doCheckBuff(this,f.BuffTime.onSkill);return o&&o.buffType===f.BuffType.Reduce&&(t=o.doFunc(this,t)),cc.tween(this.node).delay(.1).to(.05,{scale:.8}).call(function(){e.hp-=t}).to(.05,{scale:1}).start(),t},e.prototype.resetAddition=function(){this.buffAttack=0,this.buffDefence=0},e.prototype.doAddition=function(t,e,o,n){t===this.arm&&(this.buffAttack=e,this.buffDefence=o,this.energy+=n,this.energy>=r.MAX_ENERGY&&u.default.instance.doCheckSkill(this,f.SkillType.Before)&&(this.energy=0))},e.prototype.checkBuff=function(){this.node_buff.getComponents(l.default).forEach(function(t){t.continued<=0&&t.destroy()})},e.prototype.displayData=function(){var t="\u653b:"+this.attack+" \u9632:"+this.defence;this.lb_data.string=t},i([y(cc.Label)],e.prototype,"lb_name",void 0),i([y(cc.Label)],e.prototype,"lb_hp",void 0),i([y(cc.Label)],e.prototype,"lb_data",void 0),i([y(cc.ProgressBar)],e.prototype,"pb_hp",void 0),i([y(cc.ProgressBar)],e.prototype,"pb_eg",void 0),i([y(cc.Label)],e.prototype,"lb_arm",void 0),i([y(cc.Node)],e.prototype,"node_skill",void 0),i([y(cc.Node)],e.prototype,"node_buff",void 0),e=i([_],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../common/Const":"Const","../common/EventManager":"EventManager","../common/Tools":"Tools","../entity/HeroEntity":"HeroEntity","../skill/BuffComponent":"BuffComponent","../skill/SkillComponent":"SkillComponent","../skill/SkillConst":"SkillConst","../skill/SkillData":"SkillData","../skill/SkillSystem":"SkillSystem"}],ListView:[function(t,e,o){"use strict";cc._RF.push(e,"9d7b5TdwExE/pkV2ieS6idW","ListView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gfx=null,e}return n(e,t),e.prototype.onLoad=function(){this.gfx=this.node.getComponent(cc.Graphics)},e.prototype.start=function(){this.scheduleOnce(this.initStroke,0)},e.prototype.initStroke=function(){this.gfx.rect(-this.node.width/2,-this.node.height/2,this.node.width,this.node.height),this.gfx.stroke()},e=i([c],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],Refix:[function(t,e,o){"use strict";cc._RF.push(e,"a2e81lFo7JEvL5pUbHUq/B1","Refix");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){var t=cc.view.getCanvasSize();t.width/t.height<this.node.width/this.node.height?this.node.scale=t.width/this.node.width*(this.node.height/t.height):this.node.scale=1},e=i([c],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],SkillComponent:[function(t,e,o){"use strict";cc._RF.push(e,"7d0d6P3LVBOs6tWI6z+WU64","SkillComponent");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./SkillData"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skillId=r.SkillId.NULL,e}return n(e,t),Object.defineProperty(e.prototype,"skillId",{get:function(){return this._skillId},set:function(t){if(this._skillId!==t){this._skillId=t;var e=r.default(t);this.skillName=e.name,this.skillIcon=e.icon,this.skillDes=e.des,this.skillType=e.type,this.doFunc=e.func}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillName",{get:function(){return this._skillName},set:function(t){this._skillName=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillIcon",{get:function(){return this._skillIcon},set:function(t){this._skillIcon=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillDes",{get:function(){return this._skillDes},set:function(t){this._skillDes=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillType",{get:function(){return this._skillType},set:function(t){this._skillType=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doFunc",{get:function(){return this._doFunc},set:function(t){this._doFunc=t},enumerable:!1,configurable:!0}),e.prototype.initSkill=function(t){this.skillId=t},e=i([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{"./SkillData":"SkillData"}],SkillConst:[function(t,e,o){"use strict";cc._RF.push(e,"2c9577RbTBMtaJLbT28D4/m","SkillConst"),Object.defineProperty(o,"__esModule",{value:!0}),o.BuffType=o.BuffTime=o.SkillType=void 0,function(t){t[t.Before=0]="Before",t[t.Attack=1]="Attack",t[t.Recover=2]="Recover"}(o.SkillType||(o.SkillType={})),function(t){t[t.doAttack=0]="doAttack",t[t.onAttack=1]="onAttack",t[t.onSkill=2]="onSkill"}(o.BuffTime||(o.BuffTime={})),function(t){t[t.Reduce=0]="Reduce",t[t.Recover=1]="Recover",t[t.Other=2]="Other"}(o.BuffType||(o.BuffType={})),cc._RF.pop()},{}],SkillData:[function(t,e,o){"use strict";var n;cc._RF.push(e,"ebcddaqNu1CGar7A7Ake7BG","SkillData"),Object.defineProperty(o,"__esModule",{value:!0}),o.SkillId=void 0;var i,r=t("./SkillConst"),c=t("../prefab/Hero"),a=t("./BuffComponent"),s=t("./BuffData"),u=t("../common/Const"),f=t("../entity/HeroEntity"),l=t("../common/Tools");(function(t){t[t.NULL=0]="NULL",t[t.KongCheng=1]="KongCheng",t[t.HuXiaoDangYang=2]="HuXiaoDangYang",t[t.DanDaoFuHui=3]="DanDaoFuHui"})(i=o.SkillId||(o.SkillId={})),o.default=function(t){return new p(h[t])};var p=function(){return function(t){this.name=t.name,this.icon=t.icon,this.des=t.des,this.type=t.type,this.func=t.func}}(),h=((n={})[i.KongCheng]={name:"\u7a7a\u57ce\u8ba1",icon:"",des:"\u8fdb\u5165\u7a7a\u57ce\u72b6\u6001\uff0c\u672c\u56de\u5408\u514d\u75ab\u666e\u901a\u653b\u51fb\u4f24\u5bb3",type:r.SkillType.Before,func:function(t){t.node_buff.addComponent(a.default).initBuff(s.BuffId.KongCheng)}},n[i.HuXiaoDangYang]={name:"\u864e\u5578\u5f53\u9633",icon:"",des:"",type:r.SkillType.Attack,func:function(t){var e=f.HeroEntity.instance.getFront(t.camp,!0);if(0!=e.length){var o=e[l.default.randomInt(e.length)],n=o.getComponent(c.default),i=f.HeroEntity.instance.getHeros(t.camp,!0,-1,n.row),r=t.camp===u.CAMPS.LEFT?-1:1,a=o.getComponent(c.default).pos.add(cc.v2(.9*t.node.width*r,0));t.doSkill(i,.8,a,this.skillName)}}},n[i.DanDaoFuHui]={name:"\u5355\u5200\u8d74\u4f1a",icon:"",des:"",type:r.SkillType.Attack,func:function(t){var e=f.HeroEntity.instance.getLast(t.camp,!0);if(0!=e.length){var o=e[l.default.randomInt(e.length)],n=t.camp===u.CAMPS.LEFT?-1:1,i=o.getComponent(c.default).pos.add(cc.v2(.9*t.node.width*n,0));t.doSkill([o],1.2,i,this.skillName)}}},n);cc._RF.pop()},{"../common/Const":"Const","../common/Tools":"Tools","../entity/HeroEntity":"HeroEntity","../prefab/Hero":"Hero","./BuffComponent":"BuffComponent","./BuffData":"BuffData","./SkillConst":"SkillConst"}],SkillSystem:[function(t,e,o){"use strict";cc._RF.push(e,"f37b8jXhXxH3rhQcTQF0Rgu","SkillSystem"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./SkillComponent"),i=t("./BuffComponent"),r=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this._instance},enumerable:!1,configurable:!0}),t.prototype.doCheckSkill=function(t,e){var o=!1;return t.node_skill.getComponents(n.default).forEach(function(n){n.skillType===e&&(o=!0,n.doFunc(t))}),o},t.prototype.doCheckBuff=function(t,e){var o=null;return t.node_buff.getComponents(i.default).forEach(function(t){t.buffTime!==e||(o=t)}),o},t._instance=new t,t}();o.default=r,cc._RF.pop()},{"./BuffComponent":"BuffComponent","./SkillComponent":"SkillComponent"}],TableView:[function(t,e,o){"use strict";cc._RF.push(e,"81a0fX1hB5DTb743hVLsigd","TableView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../common/Const"),c=t("../common/EventManager"),a=cc._decorator,s=a.ccclass,u=a.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.strokeGfx=null,e.fillGfx=null,e.rects=[],e}return n(e,t),e.prototype.onLoad=function(){this.fillGfx=this.node.getComponent(cc.Graphics)},e.prototype.start=function(){this.scheduleOnce(this.initStroke,0)},e.prototype.initStroke=function(){this.strokeGfx.clear(),this.drawTable(!0),this.drawTable(!1),c.default.emit(r.EventType.TABLE_INIT_OVER)},e.prototype.checkCross=function(t){var e=this.node.convertToNodeSpaceAR(t),o=new cc.Rect(e.x-50,e.y-50,100,100),n=this.fillGfx,i=0,r=0;this.rects.forEach(function(t,e){if(t.intersects(o)){var n=new cc.Rect;t.intersection(n,o);var c=n.width*n.height;(i=Math.max(i,c))===c&&(r=e)}}),n.clear(),this.rects.forEach(function(t,e){0!==i&&r===e&&(n.fillColor=cc.color(0,255,0,255),n.fillRect(t.x,t.y,t.width,t.height))})},e.prototype.drawTable=function(t){var e=this.strokeGfx,o=this.node.width,n=-this.node.height/2,i=o/2-100*r.MAX_COL,c=t?-1:1;e.moveTo((o/2-i/2)*c,n),e.lineTo(i/2*c,n),e.lineTo(i/2*c,n+100*r.MAX_ROW),e.lineTo((o/2-i/2)*c,n+100*r.MAX_ROW),e.close(),e.moveTo((i/2+100)*c,n),e.lineTo((i/2+100)*c,n+100*r.MAX_ROW),e.moveTo((i/2+200)*c,n),e.lineTo((i/2+200)*c,n+100*r.MAX_ROW),e.moveTo((o/2-i/2)*c,n+100),e.lineTo(i/2*c,n+100),e.moveTo((o/2-i/2)*c,n+200),e.lineTo(i/2*c,n+200),e.stroke();for(var a=0;a<r.MAX_COL;++a)for(var s=0;s<r.MAX_ROW;++s){var u=(i/2+100*(a+(t?1:0)))*c,f=n+100*s,l=new cc.Rect(u,f,100,100);this.rects.push(l)}},e.prototype.getRects=function(){return this.rects},i([u(cc.Graphics)],e.prototype,"strokeGfx",void 0),e=i([s],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../common/Const":"Const","../common/EventManager":"EventManager"}],Tools:[function(t,e,o){"use strict";cc._RF.push(e,"aed90YH+XFPlYsMJTe5Bq8J","Tools"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.setSeed=function(t){this.seed=t},t.setOffsetUV=function(t,e,o){void 0===e&&(e="u_uvOffset"),void 0===o&&(o="u_uvRotated");var n,i,r,c,a=t.spriteFrame,s=a.uv,u=t.getMaterial(0);n=s[0],c=s[5],i=s[6],r=s[3];var f=new cc.Vec4(n,c,i,r),l=a.isRotated()?1:0;u.setProperty(e,f),u.setProperty(o,l)},t.random=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=0),this.seed=(9301*this.seed+49297)%233280,this.seed/233280*(t-e)+e},t.randomInt=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=0),Math.floor(this.random(t,e))},t}();o.default=n,cc._RF.pop()},{}]},{},["Const","EventManager","Tools","HeroEntity","GameModel","Addition","Gua","Hero","BuffComponent","BuffData","SkillComponent","SkillConst","SkillData","SkillSystem","AdditionView","GuaView","ListView","TableView","GameView","Refix"]);